/*! elasto.js - v0.1.0 - 2015-12-17 - [object Object] */
(function(){function e(e){"use strict";var t={hideIncompleteRow:!1,trackActive:!0,trackAnimation:!0,minSize:150,move:null,select:null,click:null,enter:null,keyEventsEnabled:!0,customAttributes:{},displayProperties:{image:"image",title:"title",description:"description"}},n=e.Elasto=function(e,i,r){var o,l,a,s,c,u,d,f,p,h,m=this,v=!1,g=function(){l=document.getElementById(e),l.classList.add("elasto-container"),o=i?i:[],w(),y(),window.addEventListener("keydown",W),window.addEventListener("keyup",M),window.addEventListener("resize",b),v=!0},w=function(){r=r||{},h=h||{};for(var e in t)t.hasOwnProperty(e)&&r.hasOwnProperty(e)?h[e]=r[e]:t.hasOwnProperty(e)&&(h[e]=t[e])},y=function(){for(;l.firstChild;)l.removeChild(l.firstChild);s=0,L(),h.hideIncompleteRow&&!v&&o.length>c&&c>0&&(o.splice(o.length-c,c),s=0,L()),d=null;for(var e=0;o.length>e;e++)E(e);o.length&&I(1)},E=function(e){var t=k();t.style.width=u+"%",t.setAttribute("data-elasto-id",e+1);for(var n in h.customAttributes)(function(n){if(h.customAttributes.hasOwnProperty(n)){var i=h.customAttributes[n].replace(/\{\{([^{}]+)\}\}/g,function(t){var n=t.replace(/\{/g,"").replace(/\}/g,"");return o[e].hasOwnProperty(n)?o[e][n]:t});t.setAttribute(n,i)}})(n);o[e].hasOwnProperty(h.displayProperties.image)&&o[e][h.displayProperties.image]&&(t.getElementsByClassName("elasto-square-bg")[0].style.backgroundImage="url("+o[e][h.displayProperties.image]+")"),o[e].hasOwnProperty(h.displayProperties.title)&&(t.getElementsByClassName("elasto-square-title")[0].innerHTML=o[e][h.displayProperties.title],t.getElementsByClassName("elasto-square-title")[0].title=o[e][h.displayProperties.title]),o[e].hasOwnProperty(h.displayProperties.description)&&(t.getElementsByClassName("elasto-square-description")[0].innerHTML=o[e][h.displayProperties.description]),t.addEventListener("click",q),o[e].elastoId=e+1,o[e].elem=t,l.appendChild(t),d||(d=Math.floor(t.clientWidth)),t.style.height=d+"px"},k=function(){var e=document.createElement("div");e.classList.add("elasto-square");var t=document.createElement("div");t.classList.add("elasto-square-bg");var n=document.createElement("div");n.classList.add("elasto-square-wrap");var i=document.createElement("div");i.classList.add("elasto-square-title");var r=document.createElement("div");return r.classList.add("elasto-square-description"),e.appendChild(t),e.appendChild(n),n.appendChild(i),n.appendChild(r),e.cloneNode(!0)},L=function(){var e=Math.floor(l.clientWidth),t=Math.floor(e/h.minSize);t=0===t?1:t,t!==s&&(s=t,a=Math.floor(o.length/s),c=o.length%s,u=100/s)},b=function(){p&&clearTimeout(p),p=setTimeout(P,50)},P=function(){if(o.length){var e=u.valueOf();if(L(),e!==u){o[0].elem.style.width=u+"%",d=Math.floor(o[0].elem.clientWidth);for(var t=0;o.length>t;t++)o[t].elem.style.width=u+"%",o[t].elem.style.height=d+"px"}else{d=Math.floor(o[0].elem.clientWidth);for(var n=0;o.length>n;n++)o[n].elem.style.height=d+"px"}}},I=function(e){for(var t=l.getElementsByClassName("active"),n=0;t.length>n;n++)t[n].classList.remove("active");f=e,o[e-1].elem.classList.add("active")},A=function(){return o[f-1]},T=function(){if(o.length){for(var e,t=l;t&&(e=window.getComputedStyle(t).getPropertyValue("overflow"),"visible"===e);)t=t.parentElement;var n,i,r,a,s,c,u,f,p=50;t?"hidden"!==e&&(r=C(A().elem).top,a=C(A().elem).left,s=t.scrollTop,c=s+t.clientHeight,u=t.scrollLeft,f=u+t.clientWidth,i=s,n=u,r+d+p>c?i=r+d+p-t.clientHeight:s>r-p&&(i=r-p),a+d+p>f?n=a+d+p-t.clientWidth:u>a-p&&(n=a-p),h.trackAnimation?O(t,{top:i,left:n},200):(t.scrollTop=i,t.scrollLeft=n)):(r=_(A().elem).top,a=_(A().elem).left,s=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),c=s+window.innerHeight,u=(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0),f=u+window.innerWidth,i=s,n=u,r+d+p>c?i=r+d+p-window.innerHeight:s>r-p&&(i=r-p),a+d+p>f?n=a+d+p-window.innerWidth:u>a-p&&(n=a-p),h.trackAnimation?O(document.body,{top:i,left:n},200):window.scrollTo(n,i))}},_=function(e){for(var t=0,n=0;e;)t+=parseInt(e.offsetTop,10),n+=parseInt(e.offsetLeft,10),e=e.offsetParent;return{top:t,left:n}},C=function(e){var t,n={top:parseInt(e.offsetTop,10),left:parseInt(e.offsetLeft,10)},i={top:parseInt(e.parentElement.offsetTop,10),left:parseInt(e.parentElement.offsetLeft,10)},r=window.getComputedStyle(e.parentElement).getPropertyValue("position");return t="relative"===r||"absolute"===r?n:{top:n.top-i.top,left:n.left-i.left}},O=function(e,t,i){var r=e.scrollTop,o=e.scrollLeft,l=t.top-r,a=t.left-o,s=0,c=20,u=function(){s+=c;var t=n.Easing.InOutQuad(s,r,l,i),d=n.Easing.InOutQuad(s,o,a,i);e.scrollTop=t,e.scrollLeft=d,i>s&&setTimeout(u,c)};u()},q=function(e){var t=parseInt(e.target.getAttribute("data-elasto-id"),10);if(t||(t=parseInt(e.target.parentElement.getAttribute("data-elasto-id"),10)),t){var n=f;I(t),e.preventDefault(),h.trackActive&&T(),h.click&&h.click(A()),h.move&&n!==t&&h.move(A()),h.select&&h.select(A())}},M=function(e){if(o.length&&h.keyEventsEnabled){var t=e.which||e.keycode;13===t&&(e.preventDefault(),h.enter&&h.enter(A()),h.select&&h.select(A()))}},W=function(e){if(o.length&&h.keyEventsEnabled){var t=e.which||e.keycode,n=!0;switch(t){case 38:z();break;case 40:N();break;case 37:H();break;case 39:B();break;default:n=!1}n&&(e.preventDefault(),h.trackActive&&T(),h.move&&h.move(A()))}},B=function(){var e;e=f?0===f%s?f-s+1:f===o.length?f-c+1:f+1:1,I(e)},H=function(){var e;f?0===(f-1)%s?(e=f+s-1,e>o.length&&(e=o.length)):e=f-1:e=1,I(e)},N=function(){var e;e=f?f>o.length-c?f-a*s:f+s>o.length?f-(a-1)*s:f+s:1,I(e)},z=function(){var e;f?s>=f?(e=f+a*s,e>o.length&&(e-=s)):e=f-s:e=1,I(e)};return this.resize=function(){return P(),m},this.reload=function(e){return e&&(o=e),v=!1,y(),m},this.empty=function(){return this.reload([]),m},this.add=function(e){return o.push(e),s=0,L(),E(o.length-1),1===o.length&&I(1),m},this.remove=function(e){e=parseInt(e,10);for(var t=0;o.length>t;t++)t===e-1&&o.splice(t,1);return y(),m},this.select=function(e){return e=parseInt(e,10),o.length>=e&&(I(e),h.trackActive&&T(),h.move&&h.move(A()),h.select&&h.select(A())),m},this.moveTo=function(e){return e=parseInt(e,10),o.length>=e&&(I(e),h.trackActive&&T(),h.move&&h.move(A())),m},this.__defineGetter__("active",function(){return A()}),this.__defineGetter__("data",function(){return o}),this.__defineGetter__("count",function(){return o.length}),this.__defineGetter__("options",function(){return h}),g(),this}}function t(e){"use strict";var t=e.Elasto,n=t.Easing=function(){return this};n.InOutQuad=function(e,t,n,i){return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)}}function n(e){"use strict";e.jQuery&&($.fn.elasto=function(t,n){return 1===this.length?new e.Elasto($(this).attr("id"),t,n):this})}var i=Function;new i("return this")();var r=function(i){return e(i),t(i),n(i),i.Elasto};"function"==typeof define&&define.amd?define(function(){return r({})}):r(this)})(this);